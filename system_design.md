# 数据管理与标注平台系统设计文档

## 1. 需求概述

### 1.1 系统背景
- 构建一个本地运行的数据管理与标注平台
- 处理20万份PDF文档
- 集成已开发完成的大模型算法
- 支持多用户角色协作
- 包含积分评价体系

### 1.2 系统目标
- 实现PDF文档的高效管理与分类
- 提供大模型辅助的文档识别功能
- 支持多用户标注协作流程
- 建立质量控制与溯源机制
- 实现积分评价体系

## 2. 系统架构设计

### 2.1 系统拓扑架构

```
┌─────────────────────────────────────────────────────────────┐
│                    用户层 (Web界面)                          │
├─────────────────────────────────────────────────────────────┤
│                    应用服务层                                │
│  ┌─────────────────┬─────────────────┬─────────────────┐   │
│  │ 数据管理平台    │ 数据标注平台    │ 认证授权服务      │   │
│  │                 │                 │                 │   │
│  │ - 文件管理      │ - 标注任务      │ - 用户管理      │   │
│  │ - 分类管理      │ - 质量控制      │ - 权限控制      │   │
│  │ - 表单配置      │ - 积分系统      │ - 会话管理      │   │
│  │ - 识别服务      │ - 统计分析      │                 │   │
│  └─────────────────┴─────────────────┴─────────────────┘   │
├─────────────────────────────────────────────────────────────┤
│                    数据存储层                                │
│  ┌─────────────────┬─────────────────┬─────────────────┐   │
│  │     文件存储     │    关系数据库   │    缓存存储      │   │
│  │   (PDF文件)     │  (MySQL/Postgre)│   (Redis)       │   │
│  │                 │                 │                 │   │
│  │ - 本地文件系统  │ - 用户数据      │ - 会话缓存      │   │
│  │ - 文件元数据    │ - 任务数据      │ - 临时数据      │   │
│  │ - 备份机制      │ - 标注记录      │                 │   │
│  └─────────────────┴─────────────────┴─────────────────┘   │
├─────────────────────────────────────────────────────────────┤
│                    外部服务层                                │
│  ┌─────────────────────────────────────────────────────────┐ │
│  │                大模型服务 (外部调用)                      │ │
│  │                                                         │ │
│  │ - 文档识别算法                                          │ │
│  │ - 提示词配置                                            │ │
│  │ - 字段提取                                              │ │
│  └─────────────────────────────────────────────────────────┘ │
└─────────────────────────────────────────────────────────────┘
```

### 2.2 技术栈建议

#### 前端技术栈
- **框架**: React + TypeScript
- **UI组件库**: Ant Design / Material-UI
- **状态管理**: Redux Toolkit / Zustand
- **路由**: React Router
- **PDF查看器**: React-PDF / PDF.js
- **构建工具**: Vite

#### 后端技术栈
- **框架**: Spring Boot (Java) / FastAPI (Python)
- **数据库**: PostgreSQL / MySQL
- **缓存**: Redis
- **文件存储**: 本地文件系统 + MinIO (可选)
- **消息队列**: RabbitMQ (异步处理)
- **ORM**: MyBatis / SQLAlchemy

#### 部署架构
- **容器化**: Docker + Docker Compose
- **反向代理**: Nginx
- **监控**: Prometheus + Grafana
- **日志**: ELK Stack

## 3. 数据流转设计

### 3.1 文档处理流程

```
原始PDF上传 → 分类管理 → 表单配置 → 大模型识别 → 标注任务分配 → 双人标注 → 质量检查 → 最终确认
     ↓            ↓          ↓            ↓              ↓            ↓          ↓          ↓
   文件存储     分类标签   字段模板    识别结果       任务队列     标注记录   检查记录   溯源记录
```

### 3.2 标注工作流程

```
标注任务创建 → 任务分配给标注员A → 标注员A完成标注 → 任务分配给标注员B
      ↓                      ↓                      ↓                      ↓
  管理员操作           系统自动分配             系统记录标注           系统自动分配

标注员B完成标注 → 结果比对 → 结果一致 → 标注完成
      ↓              ↓          ↓          ↓
  系统记录标注    自动比对    直接入库   任务结束

                结果不一致 → 分配给检查员 → 检查员审核 → 确定正确标注 → 标注完成
                      ↓              ↓            ↓              ↓
                   系统分配       检查员操作    选择结果       任务结束

                                                    不确定 → 修改标注 → 标注完成
                                                        ↓          ↓
                                                    检查员操作   任务结束
```

### 3.3 数据模型设计

#### 核心实体关系图

```
用户(User) ── 角色(Role)
    │
    ├── 管理员(Admin)
    ├── 标注员(Annotator)
    ├── 检查员(Reviewer)
    └── 专家(Expert)

文档(Document)
    │
    ├── 文件信息(FileInfo)
    ├── 分类信息(Category)
    ├── 识别结果(RecognitionResult)
    └── 标注记录(AnnotationRecord)

标注任务(Task)
    │
    ├── 任务分配(TaskAssignment)
    ├── 标注结果(AnnotationResult)
    └── 质量检查(QualityCheck)

积分系统(ScoreSystem)
    │
    ├── 用户积分(UserScore)
    ├── 评分记录(ScoreRecord)
    └── 溯源记录(TraceRecord)
```

## 4. 功能模块设计

### 4.1 数据管理平台

#### 4.1.1 文件管理模块
- **文件上传**: 支持批量PDF上传，文件去重校验
- **文件存储**: 本地文件系统存储，元数据管理
- **文件检索**: 按分类、状态、上传时间等条件检索
- **文件预览**: PDF在线预览，缩放、翻页功能

#### 4.1.2 分类管理模块
- **分类创建**: 创建文档分类体系
- **分类配置**: 为每个分类配置字段表单和提示词
- **分类统计**: 各分类文档数量统计

#### 4.1.3 表单配置模块
- **字段配置**: 动态配置待提取字段
- **表单设计**: 可视化表单设计器
- **验证规则**: 字段验证规则配置

#### 4.1.4 识别服务模块
- **模型调用**: 调用外部大模型API
- **结果解析**: 解析模型返回结果
- **置信度评估**: 计算识别置信度等级
- **结果存储**: 存储识别结果到数据库

### 4.2 数据标注平台

#### 4.2.1 用户管理模块
- **用户注册**: 支持多种角色注册
- **权限管理**: 基于角色的权限控制
- **用户信息**: 用户信息维护

#### 4.2.2 任务管理模块
- **任务创建**: 管理员创建标注任务
- **任务分配**: 智能分配任务给标注员
- **任务监控**: 任务进度实时监控
- **任务统计**: 任务完成情况统计

#### 4.2.3 标注工作台模块
- **双屏显示**: 左侧PDF预览，右侧标注表单
- **标注操作**: 支持字段修改、添加、删除
- **标注保存**: 自动保存草稿，支持恢复
- **标注提交**: 提交标注结果

#### 4.2.4 质量控制模块
- **结果比对**: 自动比对两位标注员结果
- **冲突处理**: 不一致结果流转到检查员
- **检查审核**: 检查员审核冲突标注
- **最终确认**: 确定最终标注结果

#### 4.2.5 积分评价模块
- **积分计算**: 基于标注质量计算积分
- **评分规则**: 配置评分规则和权重
- **溯源记录**: 完整记录每份文档处理历史
- **排行榜**: 用户积分排行展示

#### 4.2.6 统计分析模块
- **个人统计**: 用户标注统计、准确率统计
- **团队统计**: 团队工作量、质量统计
- **系统统计**: 整体标注进度、质量趋势

## 5. 页面设计

### 5.1 公共页面

#### 5.1.1 登录页面
- 用户名/密码登录
- 角色选择（如果支持多角色）
- 记住登录状态

#### 5.1.2 首页仪表板
- 系统概览统计
- 个人工作台
- 快捷操作入口

### 5.2 数据管理平台页面

#### 5.2.1 文件管理页面
- 文件列表（表格形式）
- 上传按钮
- 搜索筛选条件
- 批量操作按钮

#### 5.2.2 分类管理页面
- 分类树形结构
- 分类创建/编辑弹窗
- 分类配置面板

#### 5.2.3 表单配置页面
- 表单列表
- 表单设计器（拖拽式）
- 字段属性配置面板

#### 5.2.4 识别配置页面
- 提示词配置
- 模型参数设置
- 识别任务管理

### 5.3 数据标注平台页面

#### 5.3.1 任务列表页面
- 任务状态筛选
- 任务分配情况
- 任务操作按钮

#### 5.3.2 标注工作台页面
- 左右分屏布局
- 左侧：PDF查看器
- 右侧：标注表单
- 工具栏：缩放、标注工具

#### 5.3.3 检查审核页面
- 冲突标注列表
- 标注对比显示
- 审核操作面板

#### 5.3.4 用户管理页面
- 用户列表
- 用户角色分配
- 用户权限配置

#### 5.3.5 积分排行页面
- 积分排行榜
- 个人积分详情
- 评分规则说明

#### 5.3.6 统计分析页面
- 图表展示（使用ECharts等）
- 数据导出功能
- 自定义时间范围

## 6. 安全设计

### 6.1 认证授权
- JWT token认证
- 角色-based访问控制(RBAC)
- API权限验证

### 6.2 数据安全
- 文件上传安全校验
- SQL注入防护
- XSS防护
- 数据加密存储

### 6.3 操作审计
- 用户操作日志
- 敏感操作记录
- 审计日志分析

## 7. 性能优化设计

### 7.1 文件处理优化
- 大文件分块上传
- PDF预览缓存
- 懒加载机制

### 7.2 数据库优化
- 读写分离
- 索引优化
- 查询缓存

### 7.3 前端优化
- 组件懒加载
- 虚拟滚动
- 图片压缩

## 8. 部署运维设计

### 8.1 部署架构
- Docker容器化
- 负载均衡
- 数据库主从备份

### 8.2 监控告警
- 系统性能监控
- 业务指标监控
- 异常告警机制

### 8.3 备份恢复
- 数据定期备份
- 灾难恢复方案
- 数据一致性保证

## 9. 实施计划

### 9.1 第一阶段：基础架构搭建
- 数据库设计与搭建
- 后端基础框架搭建
- 前端基础组件开发

### 9.2 第二阶段：核心功能开发
- 数据管理平台功能
- 用户认证与权限
- 文件上传与管理

### 9.3 第三阶段：标注功能开发
- 标注工作台
- 任务分配系统
- 质量控制流程

### 9.4 第四阶段：高级功能开发
- 积分评价系统
- 统计分析功能
- 性能优化

### 9.5 第五阶段：测试部署
- 系统集成测试
- 性能压力测试
- 生产环境部署

---

本文档为系统设计方案，详细定义了数据管理与标注平台的整体架构、技术选型、功能模块和实施计划。后续开发将以此文档为指导进行具体实现。
